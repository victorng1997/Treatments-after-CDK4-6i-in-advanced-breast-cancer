---
title: "Reconstruced IPD"
output:
  html_document:
    toc: yes
    toc_depth: '5'
    df_print: paged
    toc_float: TRUE
  pdf_document:
    toc: yes
    toc_depth: 5
    highlight: tango
linestretch: 1.3
classoption: fleqn
header-includes:
- \setlength{\mathindent}{0pt}
- \setlength\parindent{0pt}
---

 


```{r include=FALSE}

library(survival)
library(survminer)
library(utils)
library(questionr)
library(knitr)
library(ggsci)
library(forestmodel)
if (!(require(meta))){
install.packages("meta")
}
library(odytools)
library(labelled)
library(kableExtra)
library(gt)
library(gtsummary)
library(haven)
setwd("C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK")
data <- read.csv2("data_ESR1.csv") 
data$Survival.time <- as.numeric(data$Survival.time)
data$y_pfs <- Surv(data$Survival.time,data$Status)


```



# ESR1

\newpage

## EMERALD




### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/ESR1/1_EMERALD.png)


### Constructed


```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "EMERALD",])

t1 <- tbl_survfit(surv1,times=c(6,12),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "EMERALD",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "EMERALD",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=1,
          surv.median.line="hv",
          xlim=c(0,25))





```




\newpage

## Accelera



### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/ESR1/2_Accelera.png)


### Constructed


```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "Accelera",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "Accelera",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "Accelera",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=2,
          surv.median.line="hv",
          xlim=c(0,14))





```




\newpage

## Ameera3



### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/ESR1/3_Ameera3.png)


### Constructed



```{r echo=FALSE, fig.height=8, fig.width=10, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "Ameera3",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.1f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "Ameera3",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "Ameera3",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=2,
          surv.median.line="hv",
          xlim=c(0,20))





```




\newpage

## Serena2



### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/ESR1/4_Serena2.png)


### Constructed



```{r echo=FALSE, fig.height=8, fig.width=18, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "Serena2",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "Serena2",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "Serena2",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=3,
          surv.median.line="hv",
          xlim=c(0,27))





```




\newpage

## EMBER3




### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/ESR1/5_Ember_3.png)


### Constructed



```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "EMBER3",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "EMBER3",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "EMBER3",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=4,
          surv.median.line="hv",
          xlim=c(0,24))





```


\newpage

## PACE




### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/ESR1/6_PACE.png)


### Constructed





```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "PACE",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "PACE",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "PACE",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=2,
          surv.median.line="hv",
          xlim=c(0,18))





```


\newpage

## MAINTAIN




### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/ESR1/7_MAINTAIN.png)


### Constructed





```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "MAINTAIN",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "MAINTAIN",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "MAINTAIN",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=6,
          surv.median.line="hv",
          xlim=c(0,30))





```

\newpage

## evERA




### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/ESR1/8_evERA.png)


### Constructed





```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "evERA",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "evERA",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "evERA",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=3,
          surv.median.line="hv",
          xlim=c(0,30))





```


```{r include=FALSE}

library(survival)
library(survminer)
library(utils)
library(questionr)
library(knitr)
library(ggsci)
library(forestmodel)
if (!(require(meta))){
install.packages("meta")
}
library(odytools)
library(labelled)
library(kableExtra)
library(gt)
library(gtsummary)
library(haven)
setwd("C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK")
data <- read.csv2("data_PI3K.csv") 
data$Survival.time <- as.numeric(data$Survival.time)
data$y_pfs <- Surv(data$Survival.time,data$Status)


```

\newpage

# PI3K

## Capitello291

### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/PI3K/1_Capitello291.png)


### Constructed

```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "Capitello291",])

t1 <- tbl_survfit(surv1,times=c(6,12),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.1f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "Capitello291",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "Capitello291",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=2,
          surv.median.line="hv",
          xlim=c(0,26))





```




\newpage

## Finner




### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/PI3K/2_Finer.png)


### Constructed


```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "Finner",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "Finner",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "Finner",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=4,
          surv.median.line="hv",
          xlim=c(0,24))





```




\newpage

## PACE



### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/PI3K/3_PACE.png)


### Constructed


```{r echo=FALSE, fig.height=8, fig.width=10, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "PACE",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "PACE",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "PACE",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=2,
          surv.median.line="hv",
          xlim=c(0,20))





```




\newpage

## MAINTAIN


### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/PI3K/4_MANTAIN.png)


### Constructed


```{r echo=FALSE, fig.height=8, fig.width=18, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "MAINTAIN",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.2f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "MAINTAIN",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "MAINTAIN",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=6,
          surv.median.line="hv",
          xlim=c(0,36))





```




\newpage

## EMBER3



### Original

![](C:/Users/victornavarro/OneDrive/OneDrive - VHIO/Escritorio/VHIO/Guillermo VIllacampa/post-CDK/corves/PI3K/5_EMBER_3.png)


### Constructed


```{r echo=FALSE, fig.height=8, fig.width=14, message=FALSE, warning=FALSE}


surv1 <- survfit(y_pfs~Group,data=data[data$Trial == "EMBER3",])

t1 <- tbl_survfit(surv1,times=c(6,12,24),label_header = "**{time} Months**",estimate_fun = function(x) sprintf("%.1f%%", x * 100))
t2 <- tbl_survfit(surv1,probs=0.5,label_header = "**Median (months 95%CI)**" ,estimate_fun = function(x) sprintf("%.1f", x))
t3 <- coxph(y_pfs~Group,data=data[data$Trial == "EMBER3",]) %>%
  tbl_regression(exponentiate = TRUE,pvalue_fun = label_style_pvalue(digits=3))
tbl_merge(list(t1,t2,t3), tab_spanner = FALSE)

mypal <- pal_jco("default")(10)[c(1,2,3,4,5,6,7,8)]

ggsurvplot(surv1 , data = data[data$Trial == "EMBER3",],
           title = " ",
           pval = T, pval.method = F,    # Add p-value &  method name
           palette = mypal,
           risk.table = T,                  # Add No at risk table
           cumevents = F,                   # Add cumulative No of events table
           tables.height = 0.15,               # Specify tables height
           tables.theme = theme_cleantable(),  # Clean theme for tables
           tables.y.text = F,
           conf.int = F, # Hide tables y axis text
           xlab= "Time (months)",
           ylab="Progression-free Survival",
           pval.size=4.5,
           risk.table.title="N. at risk",
           risk.table.fontsize=5.5,
           font.y=c(22),
           font.tickslab=20,
           size=2,
           font.x=c(20),
           linetype=c(1,1,1,1,1,1,1,1,1),
           censor.size=6,
           # legend=c(0.8,1),           # Change legend titles
           # legend.labs = nam,  # Change legend labels
           # legend.title="",
           # font.legend=c(14,"bold"),
           break.time.by=4,
          surv.median.line="hv",
          xlim=c(0,24))





```



